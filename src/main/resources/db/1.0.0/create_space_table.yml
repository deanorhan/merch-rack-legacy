databaseChangeLog:
  - changeSet:
      id: create_space_table
      author: daemio
      changes:
        - createTable:
            tableName: space
            remarks: Space on the rack
            columns:
            - column:
                name: space_id
                type: uuid
                constraints:
                  primaryKey: true
                  nullable: false
                remarks: auto generated uuid
            - column:
                name: parent
                type: uuid
                constraints:
                  foreignKeyName: parent_fk
                  references: space(space_id)
                  deleteCascade: true
                remarks: the parent space
            - column:
                name: name
                type: varchar(255)
                constraints:
                  nullable: false
                remarks: name of the space
            - column:
                name: created_at
                type: ${timestamp.type}
                constraints:
                  nullable: false
                  updatable: false
                remarks: time the space was created
            - column:
                name: created_by
                type: varchar(25)
                constraints:
                  nullable: false
                  updatable: false
                remarks: who created this space
            - column:
                name: modified_at
                type: ${timestamp.type}
                constraints:
                  nullable: false
                remarks: time the space was modified last

        - addUniqueConstraint:
            tableName: space
            columnNames: parent, space_id
            constraintName: parent_to_child_space_uidx
            validate: true
